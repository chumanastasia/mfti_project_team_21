# Проектный практикум

> Авторы:
>
> - Чумаков Михаил Дмитриевич
> - Чумакова Анастасия Ильинична
> - Пермяков Никита Петрович

## Описание проекта

Проект представляет собой минимально жизнеспособный продукт (MVP) для системы мониторинга качества нефтепродуктов.
Это позволяет нам собирать, анализировать и визуализировать данные о качестве нефтепродуктов почти в реальном времени.

Система разработана с использованием различных технологий, включая Python, Streamlit и js
для создания интерактивного веб-интерфейса, и PostgreSQL для управления базой данных.
Система также будет интегрирована с API компании "Газпром" при помощи ETL сервисов и сервисов шлюзов,
для получения и обновления данных о качестве нефтепродуктов.

Основная цель проекта - предоставить компании "Газпром" инструмент,
который поможет им быстро и эффективно анализировать качество своих нефтепродуктов,
выявлять проблемы и недостатки в процессе производства и доставки,
а также принимать своевременные решения для улучшения качества и эффективности работы.

Система предлагает различные функции для мониторинга и анализа данных,
включая дашборды для визуализации данных.
В будущем планируется добавить систему уведомлений о возможных проблемах и модуль для генерации отчетов.
Кроме того, система предоставляет возможность настройки параметров мониторинга в соответствии с потребностями компании.

Проект находится в стадии активной разработки, и мы надеемся на вашу поддержку и обратную связь для его улучшения.

## Развертка базы данных

```bash
docker run -d --name timescaledb -p 5432:5432 -e POSTGRES_PASSWORD=password timescale/timescaledb-ha:pg14-latest
```

## Установка зависимостей

```bash
poetry install
```

## Запуск приложения

```bash
poetry run python -m streamlit run src/app.py  
```

## Модели данных

Таблица для хранения временных рядов:

`time_series`

| Колонка | Тип данных                        | Описание                  |
| -------------- |-----------------------------------|---------------------------|
| time           | timestamp with time zone not null | Временная метка измерения |
| tag            | varchar(255) not null             | Имя тега временного ряда  |
| value          | double precision not null         | Значение измерения        |


Таблица для хранения конфигураций моделей:
`model_configs`

| Колонка | Тип данных                              | Описание            |
| -------------- |-----------------------------------------|---------------------|
| model_name     | model_name varchar(256) not null unique | Имя модели          |
| config         | jsonb                 | Конфигурация модели |


Генерация таблиц (не использую алембик, так как MVP):

```sql
begin;
create table time_series
(
    time  timestamp with time zone not null,
    tag   varchar(255)             not null,
    value double precision         not null
);

select create_hypertable('time_series', 'time');

create table model_configs
(
    model_name varchar(256) not null unique,
    config jsonb
);
commit;
```

## Структура проекта

```bash
.
├── README.md - Описание проекта
├── poetry.lock - Обеспечивает согласованность зависимостей проекта.
├── pyproject.toml - Содежит метаданные о проекте.
└── src
    ├── app.py - Точка входа в приложение (весь UI тут)
    ├── config.py - Модуль конфигурации приложения
    ├── db.py - Модуль с соединениями БД
    ├── extractor.py - Модуль извелечения данных из источников
    ├── repo.py - Репозитории источников данных
    ├── schemas.py - Схемы описывающие данные
    └── train.py - Модуль обучения моеделй и прогноза
```

## Метрики качества
### R2 - коэффициент детерминации
> Физический смысл R2 заключается в том, что эта метрика показывает, какую долю дисперсии зависимой переменной объясняет модель.
> То есть, если R2 равен 0.8, это означает, что 80% изменчивости зависимой переменной может быть объяснено нашей моделью.
> Остальные 20% могут быть вызваны другими факторами, которые модель не учитывает.

> R2 всегда находится в диапазоне от 0 до 1. Значение 0 означает, что модель не объясняет никакой дисперсии зависимой переменной, а значение 1 означает, что модель объясняет всю дисперсию зависимой переменной.


## RMSE (Root Mean Square Error) - квадратный корень из среднего значения квадратов ошибок
> Физический смысл RMSE заключается в том, что эта метрика показывает, насколько велика ошибка прогноза модели в среднем.
> То есть, если у нас есть набор наблюдаемых и предсказанных значений, то RMSE позволяет оценить, насколько в среднем предсказанные значения отклоняются от наблюдаемых.

> RMSE является агрегированной мерой точности прогноза и удобна для сравнения различных моделей: чем меньше значение RMSE, тем более точной можно считать модель. Однако следует помнить, что RMSE не нормирована, и поэтому ее значение сложно интерпретировать без знания масштаба переменной, которую предсказывает модель.


## Скриншот работающего проекта:
![](.README_images/433f4452.png)
